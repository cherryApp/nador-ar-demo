"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[705],{8705:(Z,c,r)=>{r.r(c),r.d(c,{HomeComponent:()=>M});var d=r(5861),t=r(9127),i=r(3403),h=r(8645),u=r(2832),m=r(4825),g=r(9773);let f=(()=>{class o{constructor(n){this.modalCtrl=n,this.name="",this.guid=""}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.modalCtrl.dismiss(this.name,"confirm")}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(i.IN))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-machine-modal"]],inputs:{name:"name",guid:"guid"},standalone:!0,features:[t._Bn([i.IN]),t.jDz],decls:16,vars:3,consts:[["slot","start"],["slot","end"],[3,"strong","click"]],template:function(e,a){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar"),t._UZ(2,"ion-buttons",0),t.TgZ(3,"ion-title"),t._uU(4,"G\xe9p Adatai"),t.qZA(),t.TgZ(5,"ion-buttons",1)(6,"ion-button",2),t.NdJ("click",function(){return a.confirm()}),t._uU(7,"Bez\xe1r"),t.qZA()()()(),t.TgZ(8,"ion-content")(9,"ion-list")(10,"ion-item")(11,"ion-label"),t._uU(12),t.qZA()(),t.TgZ(13,"ion-item")(14,"ion-label"),t._uU(15),t.qZA()()()()),2&e&&(t.xp6(6),t.Q6J("strong",!0),t.xp6(6),t.Oqu(a.name),t.xp6(3),t.Oqu(a.guid))},dependencies:[i.W2,i.Ie,i.Q$,i.q_,i.Gu,i.sr,i.YG,i.Sm,i.wd]})}return o})();const C=["video"],y=["videoContainer"];let M=(()=>{class o{constructor(){this.modalCtrl=(0,t.f3M)(i.IN),this.stopSubscriptions=new h.x,this.lastKnownQRData=null,this.isModalOpen=!1}canDismiss(n,e){return(0,d.Z)(function*(){return"gesture"!==e})()}ngOnInit(){(function v(o=0,w=u.z){return o<0&&(o=0),(0,m.H)(o,o,w)})(500).pipe((0,g.R)(this.stopSubscriptions)).subscribe(()=>{this.setVideoSize(),this.getImage()})}ngAfterViewInit(){this.startCamera()}setVideoSize(){if(!this.videoContainer||!this.video)return;const n=this.videoContainer.nativeElement.offsetWidth,e=this.videoContainer.nativeElement.offsetHeight,l=(n-this.video.nativeElement.offsetWidth)/2,E=(e-this.video.nativeElement.offsetHeight)/2;return e>n?(this.video.nativeElement.style.height=e+"px",this.video.nativeElement.style.left=l+"px"):(this.video.nativeElement.style.width=n+"px",this.video.nativeElement.style.top=E+"px"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(this.video.nativeElement.style.width="100%",void(this.video.nativeElement.style.left="0px")):void 0}startCamera(){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(n=>{this.video.nativeElement.srcObject=n}).catch(function(n){console.log("Something went wrong!")})}getImage(){var n=this;return(0,d.Z)(function*(){if(!n.video)return;const e=document.createElement("canvas");e.width=n.video.nativeElement.clientWidth,e.height=n.video.nativeElement.clientHeight;let a=e.getContext("2d");if(a&&(a.drawImage(n.video.nativeElement,0,0,e.width,e.height),0!==e.width&&0!==e.height)){var s=a.getImageData(0,0,e.width,e.height),l=jsQR(s.data,s.width,s.height,{inversionAttempts:"dontInvert"});if(l&&l.data){if((l=JSON.parse(l.data)).guid===n.lastKnownQRData?.guid)return;n.lastKnownQRData=l,yield n.openModal()}}})()}openModal(){var n=this;return(0,d.Z)(function*(){const e=yield n.modalCtrl.create({component:f,componentProps:{name:n.lastKnownQRData?.name,guid:n.lastKnownQRData?.guid}});e.present(),yield e.onWillDismiss(),n.lastKnownQRData=null})()}ngOnDestroy(){this.stopSubscriptions.next(!0)}static#t=this.\u0275fac=function(e){return new(e||o)};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-home"]],viewQuery:function(e,a){if(1&e&&(t.Gf(C,5),t.Gf(y,5)),2&e){let s;t.iGM(s=t.CRH())&&(a.video=s.first),t.iGM(s=t.CRH())&&(a.videoContainer=s.first)}},standalone:!0,features:[t._Bn([i.IN]),t.jDz],decls:6,vars:0,consts:[[1,"video-card"],["videoContainer",""],["autoPlay","true","playsInline","true","muted",""],["video",""],["content",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0,1),t._UZ(2,"video",2,3),t.qZA(),t._UZ(4,"ion-content",null,4))},dependencies:[i.W2],styles:[".video-card[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden}.video-card[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute}"]})}return o})()}}]);