"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[75],{2075:(U,f,l)=>{l.r(f),l.d(f,{HomeComponent:()=>S});var u=l(5861),i=l(6242),r=l(3403),p=l(8645),g=l(7394);class y extends g.w0{constructor(n,t){super()}schedule(n,t=0){return this}}const h={setInterval(s,n,...t){const{delegate:e}=h;return e?.setInterval?e.setInterval(s,n,...t):setInterval(s,n,...t)},clearInterval(s){const{delegate:n}=h;return(n?.clearInterval||clearInterval)(s)},delegate:void 0};var w=l(9039);const v={now:()=>(v.delegate||Date).now(),delegate:void 0};class d{constructor(n,t=d.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,e){return new this.schedulerActionCtor(this,n).schedule(e,t)}}d.now=v.now;const m=new class I extends d{constructor(n,t=d.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let e;this._active=!0;do{if(e=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,e){for(;n=t.shift();)n.unsubscribe();throw e}}}(class C extends y{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var e;if(this.closed)return this;this.state=n;const o=this.id,a=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(a,o,t)),this.pending=!0,this.delay=t,this.id=null!==(e=this.id)&&void 0!==e?e:this.requestAsyncId(a,this.id,t),this}requestAsyncId(n,t,e=0){return h.setInterval(n.flush.bind(n,this),e)}recycleAsyncId(n,t,e=0){if(null!=e&&this.delay===e&&!1===this.pending)return t;null!=t&&h.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const e=this._execute(n,t);if(e)return e;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let o,e=!1;try{this.work(n)}catch(a){e=!0,o=a||new Error("Scheduled action threw falsy error")}if(e)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:e}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,w.P)(e,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}),A=m;var D=l(5592),M=l(671);var b=l(9773);let H=(()=>{class s{constructor(t){this.modalCtrl=t,this.name="",this.guid=""}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.modalCtrl.dismiss(this.name,"confirm")}ngOnInit(){}static#t=this.\u0275fac=function(e){return new(e||s)(i.Y36(r.IN))};static#e=this.\u0275cmp=i.Xpm({type:s,selectors:[["app-machine-modal"]],inputs:{name:"name",guid:"guid"},standalone:!0,features:[i._Bn([r.IN]),i.jDz],decls:16,vars:3,consts:[["slot","start"],["slot","end"],[3,"strong","click"]],template:function(e,o){1&e&&(i.TgZ(0,"ion-header")(1,"ion-toolbar"),i._UZ(2,"ion-buttons",0),i.TgZ(3,"ion-title"),i._uU(4,"G\xe9p Adatai"),i.qZA(),i.TgZ(5,"ion-buttons",1)(6,"ion-button",2),i.NdJ("click",function(){return o.confirm()}),i._uU(7,"Bez\xe1r"),i.qZA()()()(),i.TgZ(8,"ion-content")(9,"ion-list")(10,"ion-item")(11,"ion-label"),i._uU(12),i.qZA()(),i.TgZ(13,"ion-item")(14,"ion-label"),i._uU(15),i.qZA()()()()),2&e&&(i.xp6(6),i.Q6J("strong",!0),i.xp6(6),i.Oqu(o.name),i.xp6(3),i.Oqu(o.guid))},dependencies:[r.W2,r.Ie,r.Q$,r.q_,r.Gu,r.sr,r.YG,r.Sm,r.wd]})}return s})();const Q=["video"],R=["videoContainer"];let S=(()=>{class s{constructor(){this.modalCtrl=(0,i.f3M)(r.IN),this.stopSubscriptions=new p.x,this.lastKnownQRData=null,this.isModalOpen=!1}canDismiss(t,e){return(0,u.Z)(function*(){return"gesture"!==e})()}ngOnInit(){(function Z(s=0,n=m){return s<0&&(s=0),function E(s=0,n,t=A){let e=-1;return null!=n&&((0,M.K)(n)?t=n:e=n),new D.y(o=>{let a=function x(s){return s instanceof Date&&!isNaN(s)}(s)?+s-t.now():s;a<0&&(a=0);let c=0;return t.schedule(function(){o.closed||(o.next(c++),0<=e?this.schedule(void 0,e):o.complete())},a)})}(s,s,n)})(500).pipe((0,b.R)(this.stopSubscriptions)).subscribe(()=>{this.setVideoSize(),this.getImage(),console.log(this.isModalOpen)})}ngAfterViewInit(){this.startCamera()}setVideoSize(){if(!this.videoContainer||!this.video)return;const t=this.videoContainer.nativeElement.offsetWidth,e=this.videoContainer.nativeElement.offsetHeight,c=(t-this.video.nativeElement.offsetWidth)/2,O=(e-this.video.nativeElement.offsetHeight)/2;e>t?(this.video.nativeElement.style.height=e+"px",this.video.nativeElement.style.left=c+"px"):(this.video.nativeElement.style.width=t+"px",this.video.nativeElement.style.top=O+"px")}startCamera(){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{this.video.nativeElement.srcObject=t}).catch(function(t){console.log("Something went wrong!")})}getImage(){var t=this;return(0,u.Z)(function*(){if(!t.video)return;const e=document.createElement("canvas");e.width=t.video.nativeElement.clientWidth,e.height=t.video.nativeElement.clientHeight;let o=e.getContext("2d");if(o){o.drawImage(t.video.nativeElement,0,0,e.width,e.height);var a=o.getImageData(0,0,e.width,e.height),c=jsQR(a.data,a.width,a.height,{inversionAttempts:"dontInvert"});if(c&&c.data){if((c=JSON.parse(c.data)).guid===t.lastKnownQRData?.guid)return;t.lastKnownQRData=c,yield t.openModal()}}})()}openModal(){var t=this;return(0,u.Z)(function*(){const e=yield t.modalCtrl.create({component:H,componentProps:{name:t.lastKnownQRData?.name,guid:t.lastKnownQRData?.guid}});e.present(),yield e.onWillDismiss(),t.lastKnownQRData=null})()}ngOnDestroy(){this.stopSubscriptions.next(!0)}static#t=this.\u0275fac=function(e){return new(e||s)};static#e=this.\u0275cmp=i.Xpm({type:s,selectors:[["app-home"]],viewQuery:function(e,o){if(1&e&&(i.Gf(Q,5),i.Gf(R,5)),2&e){let a;i.iGM(a=i.CRH())&&(o.video=a.first),i.iGM(a=i.CRH())&&(o.videoContainer=a.first)}},standalone:!0,features:[i._Bn([r.IN]),i.jDz],decls:6,vars:0,consts:[[1,"video-card"],["videoContainer",""],["autoplay",""],["video",""],["content",""]],template:function(e,o){1&e&&(i.TgZ(0,"div",0,1),i._UZ(2,"video",2,3),i.qZA(),i._UZ(4,"ion-content",null,4))},dependencies:[r.W2],styles:[".video-card[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden}.video-card[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{position:absolute}"]})}return s})()}}]);